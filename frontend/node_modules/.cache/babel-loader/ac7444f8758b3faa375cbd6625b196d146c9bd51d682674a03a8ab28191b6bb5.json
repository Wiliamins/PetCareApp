{"ast":null,"code":"/**\n * PetCareApp - Serwis API\n * Główny moduł do komunikacji z mikroserwisami backendu\n * @author VS\n */\n\nimport axios from 'axios';\n\n// Konfiguracja bazowych URL dla mikroserwisów - VS\nconst API_CONFIG = {\n  AUTH_SERVICE: process.env.REACT_APP_AUTH_SERVICE_URL || 'http://localhost:8001/api/v1',\n  USER_SERVICE: process.env.REACT_APP_USER_SERVICE_URL || 'http://localhost:8002/api/v1',\n  MEDICAL_SERVICE: process.env.REACT_APP_MEDICAL_SERVICE_URL || 'http://localhost:8003/api/v1',\n  APPOINTMENT_SERVICE: process.env.REACT_APP_APPOINTMENT_SERVICE_URL || 'http://localhost:8004/api/v1',\n  NOTIFICATION_SERVICE: process.env.REACT_APP_NOTIFICATION_SERVICE_URL || 'http://localhost:8005/api/v1',\n  PAYMENT_SERVICE: process.env.REACT_APP_PAYMENT_SERVICE_URL || 'http://localhost:8006/api/v1',\n  REPORT_SERVICE: process.env.REACT_APP_REPORT_SERVICE_URL || 'http://localhost:8007/api/v1',\n  ANALYTICS_SERVICE: process.env.REACT_APP_ANALYTICS_SERVICE_URL || 'http://localhost:8008/api/v1',\n  AUDIT_SERVICE: process.env.REACT_APP_AUDIT_SERVICE_URL || 'http://localhost:8009/api/v1',\n  DRUG_SERVICE: process.env.REACT_APP_DRUG_SERVICE_URL || 'http://localhost:8010/api/v1',\n  DISEASE_ALERT_SERVICE: process.env.REACT_APP_DISEASE_ALERT_SERVICE_URL || 'http://localhost:8011/api/v1'\n};\n\n/**\n * Tworzenie instancji axios z konfiguracją\n * @param {string} baseURL - Bazowy URL mikroserwisu\n * @returns {AxiosInstance} Skonfigurowana instancja axios\n */\nconst createApiInstance = baseURL => {\n  const instance = axios.create({\n    baseURL,\n    timeout: 30000,\n    headers: {\n      'Content-Type': 'application/json',\n      'Accept': 'application/json'\n    }\n  });\n\n  // Interceptor dla requestów - dodawanie tokena - VS\n  instance.interceptors.request.use(config => {\n    const token = localStorage.getItem('accessToken');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n\n    // Dodanie języka - VS\n    const language = localStorage.getItem('language') || 'pl';\n    config.headers['Accept-Language'] = language;\n    return config;\n  }, error => {\n    return Promise.reject(error);\n  });\n\n  // Interceptor dla odpowiedzi - obsługa błędów i refresh token - VS\n  instance.interceptors.response.use(response => response, async error => {\n    var _error$response, _error$response2, _error$response3, _error$response3$data, _error$response4, _error$response4$data, _error$response5, _error$response5$data;\n    const originalRequest = error.config;\n\n    // Jeśli błąd 401 i nie jest to retry - próbuj odświeżyć token - VS\n    if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      try {\n        const refreshToken = localStorage.getItem('refreshToken');\n        if (refreshToken) {\n          const response = await axios.post(`${API_CONFIG.AUTH_SERVICE}/auth/refresh`, {\n            refreshToken\n          });\n          const {\n            accessToken\n          } = response.data;\n          localStorage.setItem('accessToken', accessToken);\n          originalRequest.headers.Authorization = `Bearer ${accessToken}`;\n          return instance(originalRequest);\n        }\n      } catch (refreshError) {\n        // Jeśli refresh się nie powiódł - wyloguj - VS\n        localStorage.removeItem('accessToken');\n        localStorage.removeItem('refreshToken');\n        window.location.href = '/login';\n        return Promise.reject(refreshError);\n      }\n    }\n\n    // Formatowanie błędu - VS\n    const formattedError = {\n      status: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status,\n      message: ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || error.message,\n      code: (_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.code,\n      details: (_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.details\n    };\n    return Promise.reject(formattedError);\n  });\n  return instance;\n};\n\n// Instancje API dla każdego mikroserwisu - VS\nexport const authApi = createApiInstance(API_CONFIG.AUTH_SERVICE);\nexport const userApi = createApiInstance(API_CONFIG.USER_SERVICE);\nexport const medicalApi = createApiInstance(API_CONFIG.MEDICAL_SERVICE);\nexport const appointmentApi = createApiInstance(API_CONFIG.APPOINTMENT_SERVICE);\nexport const notificationApi = createApiInstance(API_CONFIG.NOTIFICATION_SERVICE);\nexport const paymentApi = createApiInstance(API_CONFIG.PAYMENT_SERVICE);\nexport const reportApi = createApiInstance(API_CONFIG.REPORT_SERVICE);\nexport const analyticsApi = createApiInstance(API_CONFIG.ANALYTICS_SERVICE);\nexport const auditApi = createApiInstance(API_CONFIG.AUDIT_SERVICE);\nexport const drugApi = createApiInstance(API_CONFIG.DRUG_SERVICE);\nexport const diseaseAlertApi = createApiInstance(API_CONFIG.DISEASE_ALERT_SERVICE);\n\n// Export konfiguracji - VS\nexport { API_CONFIG };\n\n// Domyślny eksport z wszystkimi instancjami - VS\nexport default {\n  auth: authApi,\n  user: userApi,\n  medical: medicalApi,\n  appointment: appointmentApi,\n  notification: notificationApi,\n  payment: paymentApi,\n  report: reportApi,\n  analytics: analyticsApi,\n  audit: auditApi,\n  drug: drugApi,\n  diseaseAlert: diseaseAlertApi\n};","map":{"version":3,"names":["axios","API_CONFIG","AUTH_SERVICE","process","env","REACT_APP_AUTH_SERVICE_URL","USER_SERVICE","REACT_APP_USER_SERVICE_URL","MEDICAL_SERVICE","REACT_APP_MEDICAL_SERVICE_URL","APPOINTMENT_SERVICE","REACT_APP_APPOINTMENT_SERVICE_URL","NOTIFICATION_SERVICE","REACT_APP_NOTIFICATION_SERVICE_URL","PAYMENT_SERVICE","REACT_APP_PAYMENT_SERVICE_URL","REPORT_SERVICE","REACT_APP_REPORT_SERVICE_URL","ANALYTICS_SERVICE","REACT_APP_ANALYTICS_SERVICE_URL","AUDIT_SERVICE","REACT_APP_AUDIT_SERVICE_URL","DRUG_SERVICE","REACT_APP_DRUG_SERVICE_URL","DISEASE_ALERT_SERVICE","REACT_APP_DISEASE_ALERT_SERVICE_URL","createApiInstance","baseURL","instance","create","timeout","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","language","error","Promise","reject","response","_error$response","_error$response2","_error$response3","_error$response3$data","_error$response4","_error$response4$data","_error$response5","_error$response5$data","originalRequest","status","_retry","refreshToken","post","accessToken","data","setItem","refreshError","removeItem","window","location","href","formattedError","message","code","details","authApi","userApi","medicalApi","appointmentApi","notificationApi","paymentApi","reportApi","analyticsApi","auditApi","drugApi","diseaseAlertApi","auth","user","medical","appointment","notification","payment","report","analytics","audit","drug","diseaseAlert"],"sources":["C:/Users/Viliam/Desktop/petcareapp-final/petcareapp/frontend/src/services/api.js"],"sourcesContent":["/**\n * PetCareApp - Serwis API\n * Główny moduł do komunikacji z mikroserwisami backendu\n * @author VS\n */\n\nimport axios from 'axios';\n\n// Konfiguracja bazowych URL dla mikroserwisów - VS\nconst API_CONFIG = {\n    AUTH_SERVICE: process.env.REACT_APP_AUTH_SERVICE_URL || 'http://localhost:8001/api/v1',\n    USER_SERVICE: process.env.REACT_APP_USER_SERVICE_URL || 'http://localhost:8002/api/v1',\n    MEDICAL_SERVICE: process.env.REACT_APP_MEDICAL_SERVICE_URL || 'http://localhost:8003/api/v1',\n    APPOINTMENT_SERVICE: process.env.REACT_APP_APPOINTMENT_SERVICE_URL || 'http://localhost:8004/api/v1',\n    NOTIFICATION_SERVICE: process.env.REACT_APP_NOTIFICATION_SERVICE_URL || 'http://localhost:8005/api/v1',\n    PAYMENT_SERVICE: process.env.REACT_APP_PAYMENT_SERVICE_URL || 'http://localhost:8006/api/v1',\n    REPORT_SERVICE: process.env.REACT_APP_REPORT_SERVICE_URL || 'http://localhost:8007/api/v1',\n    ANALYTICS_SERVICE: process.env.REACT_APP_ANALYTICS_SERVICE_URL || 'http://localhost:8008/api/v1',\n    AUDIT_SERVICE: process.env.REACT_APP_AUDIT_SERVICE_URL || 'http://localhost:8009/api/v1',\n    DRUG_SERVICE: process.env.REACT_APP_DRUG_SERVICE_URL || 'http://localhost:8010/api/v1',\n    DISEASE_ALERT_SERVICE: process.env.REACT_APP_DISEASE_ALERT_SERVICE_URL || 'http://localhost:8011/api/v1'\n};\n\n/**\n * Tworzenie instancji axios z konfiguracją\n * @param {string} baseURL - Bazowy URL mikroserwisu\n * @returns {AxiosInstance} Skonfigurowana instancja axios\n */\nconst createApiInstance = (baseURL) => {\n    const instance = axios.create({\n        baseURL,\n        timeout: 30000,\n        headers: {\n            'Content-Type': 'application/json',\n            'Accept': 'application/json'\n        }\n    });\n\n    // Interceptor dla requestów - dodawanie tokena - VS\n    instance.interceptors.request.use(\n        (config) => {\n            const token = localStorage.getItem('accessToken');\n            if (token) {\n                config.headers.Authorization = `Bearer ${token}`;\n            }\n            \n            // Dodanie języka - VS\n            const language = localStorage.getItem('language') || 'pl';\n            config.headers['Accept-Language'] = language;\n            \n            return config;\n        },\n        (error) => {\n            return Promise.reject(error);\n        }\n    );\n\n    // Interceptor dla odpowiedzi - obsługa błędów i refresh token - VS\n    instance.interceptors.response.use(\n        (response) => response,\n        async (error) => {\n            const originalRequest = error.config;\n\n            // Jeśli błąd 401 i nie jest to retry - próbuj odświeżyć token - VS\n            if (error.response?.status === 401 && !originalRequest._retry) {\n                originalRequest._retry = true;\n\n                try {\n                    const refreshToken = localStorage.getItem('refreshToken');\n                    if (refreshToken) {\n                        const response = await axios.post(\n                            `${API_CONFIG.AUTH_SERVICE}/auth/refresh`,\n                            { refreshToken }\n                        );\n\n                        const { accessToken } = response.data;\n                        localStorage.setItem('accessToken', accessToken);\n\n                        originalRequest.headers.Authorization = `Bearer ${accessToken}`;\n                        return instance(originalRequest);\n                    }\n                } catch (refreshError) {\n                    // Jeśli refresh się nie powiódł - wyloguj - VS\n                    localStorage.removeItem('accessToken');\n                    localStorage.removeItem('refreshToken');\n                    window.location.href = '/login';\n                    return Promise.reject(refreshError);\n                }\n            }\n\n            // Formatowanie błędu - VS\n            const formattedError = {\n                status: error.response?.status,\n                message: error.response?.data?.message || error.message,\n                code: error.response?.data?.code,\n                details: error.response?.data?.details\n            };\n\n            return Promise.reject(formattedError);\n        }\n    );\n\n    return instance;\n};\n\n// Instancje API dla każdego mikroserwisu - VS\nexport const authApi = createApiInstance(API_CONFIG.AUTH_SERVICE);\nexport const userApi = createApiInstance(API_CONFIG.USER_SERVICE);\nexport const medicalApi = createApiInstance(API_CONFIG.MEDICAL_SERVICE);\nexport const appointmentApi = createApiInstance(API_CONFIG.APPOINTMENT_SERVICE);\nexport const notificationApi = createApiInstance(API_CONFIG.NOTIFICATION_SERVICE);\nexport const paymentApi = createApiInstance(API_CONFIG.PAYMENT_SERVICE);\nexport const reportApi = createApiInstance(API_CONFIG.REPORT_SERVICE);\nexport const analyticsApi = createApiInstance(API_CONFIG.ANALYTICS_SERVICE);\nexport const auditApi = createApiInstance(API_CONFIG.AUDIT_SERVICE);\nexport const drugApi = createApiInstance(API_CONFIG.DRUG_SERVICE);\nexport const diseaseAlertApi = createApiInstance(API_CONFIG.DISEASE_ALERT_SERVICE);\n\n// Export konfiguracji - VS\nexport { API_CONFIG };\n\n// Domyślny eksport z wszystkimi instancjami - VS\nexport default {\n    auth: authApi,\n    user: userApi,\n    medical: medicalApi,\n    appointment: appointmentApi,\n    notification: notificationApi,\n    payment: paymentApi,\n    report: reportApi,\n    analytics: analyticsApi,\n    audit: auditApi,\n    drug: drugApi,\n    diseaseAlert: diseaseAlertApi\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}