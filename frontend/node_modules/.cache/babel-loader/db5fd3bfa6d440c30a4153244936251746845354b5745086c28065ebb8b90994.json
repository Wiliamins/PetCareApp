{"ast":null,"code":"import _objectSpread from\"C:/Users/Viliam/Desktop/petcareapp-final/petcareapp/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\n * PetCareApp - Kontekst autoryzacji\n * Zarządzanie stanem użytkownika, logowanie, wylogowanie, rejestracja\n * @author VS\n */import React,{createContext,useContext,useState,useEffect,useCallback}from'react';import{authService}from'../services/authService';// Tworzenie kontekstu - VS\nimport{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);/**\n * Provider kontekstu autoryzacji\n * @param {Object} props - Właściwości komponentu\n * @param {React.ReactNode} props.children - Komponenty dzieci\n */export function AuthProvider(_ref){let{children}=_ref;// Stan użytkownika - VS\nconst[user,setUser]=useState(null);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);// Sprawdzenie sesji przy starcie aplikacji - VS\nuseEffect(()=>{const checkAuth=async()=>{try{const token=localStorage.getItem('accessToken');if(token){const userData=await authService.verifyToken(token);setUser(userData);}}catch(err){localStorage.removeItem('accessToken');localStorage.removeItem('refreshToken');console.error('Błąd weryfikacji tokena:',err);}finally{setIsLoading(false);}};checkAuth();},[]);/**\n     * Logowanie użytkownika\n     * @param {string} email - Adres email\n     * @param {string} password - Hasło\n     * @param {string} role - Rola użytkownika\n     */const login=useCallback(async(email,password,role)=>{setIsLoading(true);setError(null);try{const response=await authService.login(email,password,role);// Zapisanie tokenów - VS\nlocalStorage.setItem('accessToken',response.accessToken);localStorage.setItem('refreshToken',response.refreshToken);setUser(response.user);return response.user;}catch(err){setError(err.message);throw err;}finally{setIsLoading(false);}},[]);/**\n     * Rejestracja nowego użytkownika (tylko klient)\n     * @param {Object} userData - Dane rejestracyjne\n     */const register=useCallback(async userData=>{setIsLoading(true);setError(null);try{const response=await authService.register(userData);return response;}catch(err){setError(err.message);throw err;}finally{setIsLoading(false);}},[]);/**\n     * Wylogowanie użytkownika\n     */const logout=useCallback(async()=>{try{await authService.logout();}catch(err){console.error('Błąd wylogowania:',err);}finally{// Zawsze czyścimy stan lokalny - VS\nlocalStorage.removeItem('accessToken');localStorage.removeItem('refreshToken');setUser(null);}},[]);/**\n     * Resetowanie hasła\n     * @param {string} email - Adres email\n     */const resetPassword=useCallback(async email=>{setIsLoading(true);setError(null);try{await authService.resetPassword(email);}catch(err){setError(err.message);throw err;}finally{setIsLoading(false);}},[]);/**\n     * Aktualizacja danych użytkownika\n     * @param {Object} updates - Dane do aktualizacji\n     */const updateUser=useCallback(async updates=>{try{const updatedUser=await authService.updateProfile(updates);setUser(prev=>_objectSpread(_objectSpread({},prev),updatedUser));return updatedUser;}catch(err){setError(err.message);throw err;}},[]);// Wartość kontekstu - VS\nconst value={user,isLoading,error,isAuthenticated:!!user,login,register,logout,resetPassword,updateUser,clearError:()=>setError(null)};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});}/**\n * Hook do użycia kontekstu autoryzacji\n * @returns {Object} Kontekst autoryzacji\n */export function useAuth(){const context=useContext(AuthContext);if(!context){throw new Error('useAuth musi być użyty wewnątrz AuthProvider');}return context;}export default AuthContext;","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","authService","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","isLoading","setIsLoading","error","setError","checkAuth","token","localStorage","getItem","userData","verifyToken","err","removeItem","console","login","email","password","role","response","setItem","accessToken","refreshToken","message","register","logout","resetPassword","updateUser","updates","updatedUser","updateProfile","prev","_objectSpread","value","isAuthenticated","clearError","Provider","useAuth","context","Error"],"sources":["C:/Users/Viliam/Desktop/petcareapp-final/petcareapp/frontend/src/context/AuthContext.js"],"sourcesContent":["/**\n * PetCareApp - Kontekst autoryzacji\n * Zarządzanie stanem użytkownika, logowanie, wylogowanie, rejestracja\n * @author VS\n */\n\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport { authService } from '../services/authService';\n\n// Tworzenie kontekstu - VS\nconst AuthContext = createContext(null);\n\n/**\n * Provider kontekstu autoryzacji\n * @param {Object} props - Właściwości komponentu\n * @param {React.ReactNode} props.children - Komponenty dzieci\n */\nexport function AuthProvider({ children }) {\n    // Stan użytkownika - VS\n    const [user, setUser] = useState(null);\n    const [isLoading, setIsLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    // Sprawdzenie sesji przy starcie aplikacji - VS\n    useEffect(() => {\n        const checkAuth = async () => {\n            try {\n                const token = localStorage.getItem('accessToken');\n                if (token) {\n                    const userData = await authService.verifyToken(token);\n                    setUser(userData);\n                }\n            } catch (err) {\n                localStorage.removeItem('accessToken');\n                localStorage.removeItem('refreshToken');\n                console.error('Błąd weryfikacji tokena:', err);\n            } finally {\n                setIsLoading(false);\n            }\n        };\n\n        checkAuth();\n    }, []);\n\n    /**\n     * Logowanie użytkownika\n     * @param {string} email - Adres email\n     * @param {string} password - Hasło\n     * @param {string} role - Rola użytkownika\n     */\n    const login = useCallback(async (email, password, role) => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const response = await authService.login(email, password, role);\n            \n            // Zapisanie tokenów - VS\n            localStorage.setItem('accessToken', response.accessToken);\n            localStorage.setItem('refreshToken', response.refreshToken);\n            \n            setUser(response.user);\n            return response.user;\n        } catch (err) {\n            setError(err.message);\n            throw err;\n        } finally {\n            setIsLoading(false);\n        }\n    }, []);\n\n    /**\n     * Rejestracja nowego użytkownika (tylko klient)\n     * @param {Object} userData - Dane rejestracyjne\n     */\n    const register = useCallback(async (userData) => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const response = await authService.register(userData);\n            return response;\n        } catch (err) {\n            setError(err.message);\n            throw err;\n        } finally {\n            setIsLoading(false);\n        }\n    }, []);\n\n    /**\n     * Wylogowanie użytkownika\n     */\n    const logout = useCallback(async () => {\n        try {\n            await authService.logout();\n        } catch (err) {\n            console.error('Błąd wylogowania:', err);\n        } finally {\n            // Zawsze czyścimy stan lokalny - VS\n            localStorage.removeItem('accessToken');\n            localStorage.removeItem('refreshToken');\n            setUser(null);\n        }\n    }, []);\n\n    /**\n     * Resetowanie hasła\n     * @param {string} email - Adres email\n     */\n    const resetPassword = useCallback(async (email) => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            await authService.resetPassword(email);\n        } catch (err) {\n            setError(err.message);\n            throw err;\n        } finally {\n            setIsLoading(false);\n        }\n    }, []);\n\n    /**\n     * Aktualizacja danych użytkownika\n     * @param {Object} updates - Dane do aktualizacji\n     */\n    const updateUser = useCallback(async (updates) => {\n        try {\n            const updatedUser = await authService.updateProfile(updates);\n            setUser(prev => ({ ...prev, ...updatedUser }));\n            return updatedUser;\n        } catch (err) {\n            setError(err.message);\n            throw err;\n        }\n    }, []);\n\n    // Wartość kontekstu - VS\n    const value = {\n        user,\n        isLoading,\n        error,\n        isAuthenticated: !!user,\n        login,\n        register,\n        logout,\n        resetPassword,\n        updateUser,\n        clearError: () => setError(null)\n    };\n\n    return (\n        <AuthContext.Provider value={value}>\n            {children}\n        </AuthContext.Provider>\n    );\n}\n\n/**\n * Hook do użycia kontekstu autoryzacji\n * @returns {Object} Kontekst autoryzacji\n */\nexport function useAuth() {\n    const context = useContext(AuthContext);\n    \n    if (!context) {\n        throw new Error('useAuth musi być użyty wewnątrz AuthProvider');\n    }\n    \n    return context;\n}\n\nexport default AuthContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}